<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
  <head>
    <title>Benchmark</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  </head>
  <body class="class">
    <h1><span class="path"></span><span>::</span><span class="name">Benchmark</span></h1>
    <hr />
    
    <div class="comment">
      <p>The Benchmark module provides methods to measure and report the time used to execute Ruby code.</p><ul><li>Measure the time to construct the string given by the expression <tt>&quot;a&quot;*1_000_000</tt>:</li><pre>    require 'benchmark'

    puts Benchmark.measure { &quot;a&quot;*1_000_000 }
</pre><p>On my machine (FreeBSD 3.2 on P5, 100MHz) this generates:</p><pre>    1.166667   0.050000   1.216667 (  0.571355)
</pre><p>This report shows the user CPU time, system CPU time, the sum of the user and system CPU times, and the elapsed real time. The unit of time is seconds.</p><li>Do some experiments sequentially using the #bm method:</li><pre>    require 'benchmark'

    n = 50000
    Benchmark.bm do |x|
      x.report { for i in 1..n; a = &quot;1&quot;; end }
      x.report { n.times do   ; a = &quot;1&quot;; end }
      x.report { 1.upto(n) do ; a = &quot;1&quot;; end }
    end
</pre><p>The result:</p><pre>           user     system      total        real
       1.033333   0.016667   1.016667 (  0.492106)
       1.483333   0.000000   1.483333 (  0.694605)
       1.516667   0.000000   1.516667 (  0.711077)
</pre><li>Continuing the previous example, put a label in each report:</li><pre>    require 'benchmark'

    n = 50000
    Benchmark.bm(7) do |x|
      x.report(&quot;for:&quot;)   { for i in 1..n; a = &quot;1&quot;; end }
      x.report(&quot;times:&quot;) { n.times do   ; a = &quot;1&quot;; end }
      x.report(&quot;upto:&quot;)  { 1.upto(n) do ; a = &quot;1&quot;; end }
    end
</pre></ul><p>The result:</p><pre>                    user     system      total        real
       for:     1.050000   0.000000   1.050000 (  0.503462)
       times:   1.533333   0.016667   1.550000 (  0.735473)
       upto:    1.500000   0.016667   1.516667 (  0.711239)
</pre><ul><li>The times for some benchmarks depend on the order in which items are run. These differences are due to the cost of memory allocation and garbage collection. To avoid these discrepancies, the #bmbm method is provided. For example, to compare ways to sort an array of floats:</li><pre>    require 'benchmark'

    array = (1..1000000).map { rand }

    Benchmark.bmbm do |x|
      x.report(&quot;sort!&quot;) { array.dup.sort! }
      x.report(&quot;sort&quot;)  { array.dup.sort  }
    end
</pre><p>The result:</p><pre>     Rehearsal -----------------------------------------
     sort!  11.928000   0.010000  11.938000 ( 12.756000)
     sort   13.048000   0.020000  13.068000 ( 13.857000)
     ------------------------------- total: 25.006000sec

                 user     system      total        real
     sort!  12.959000   0.010000  12.969000 ( 13.793000)
     sort   12.007000   0.000000  12.007000 ( 12.791000)
</pre><li>Report statistics of sequential experiments with unique labels, using the #benchmark method:</li><pre>    require 'benchmark'

    n = 50000
    Benchmark.benchmark(&quot; &quot;*7 + CAPTION, 7, FMTSTR, &quot;&gt;total:&quot;, &quot;&gt;avg:&quot;) do |x|
      tf = x.report(&quot;for:&quot;)   { for i in 1..n; a = &quot;1&quot;; end }
      tt = x.report(&quot;times:&quot;) { n.times do   ; a = &quot;1&quot;; end }
      tu = x.report(&quot;upto:&quot;)  { 1.upto(n) do ; a = &quot;1&quot;; end }
      [tf+tt+tu, (tf+tt+tu)/3]
    end
</pre><p>The result:</p><pre>                  user     system      total        real
     for:     1.016667   0.016667   1.033333 (  0.485749)
     times:   1.450000   0.016667   1.466667 (  0.681367)
     upto:    1.533333   0.000000   1.533333 (  0.722166)
     &gt;total:  4.000000   0.033333   4.033333 (  1.889282)
     &gt;avg:    1.333333   0.011111   1.344444 (  0.629761)
</pre></ul>
    </div>
    
    
    <h2>Instance methods</h2>
    <ul>
      
      <li>benchmark</li>
      
      <li>bm</li>
      
      <li>bmbm</li>
      
      <li>measure</li>
      
      <li>realtime</li>
      
    </ul>
    
    
    
    
    
    <h2>Constants</h2>
    <table>
      
        <tr>
          <td>BENCHMARK_VERSION</td>
          <td><code>&quot;2002-04-25&quot;</code></td>
        </tr>
        
      
        <tr>
          <td>CAPTION</td>
          <td><code>Benchmark::Tms::CAPTION</code></td>
        </tr>
        
        <tr class="comment">
          <td colspan="2"><p>The default caption string (heading above the output times).</p></td>
        </tr>
        
      
        <tr>
          <td>FMTSTR</td>
          <td><code>Benchmark::Tms::FMTSTR</code></td>
        </tr>
        
        <tr class="comment">
          <td colspan="2"><p>The default format string used to display times. See also Benchmark::Tms#format.</p></td>
        </tr>
        
      
    </table>
    
  </body>
</html>
